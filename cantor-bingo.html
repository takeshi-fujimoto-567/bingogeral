<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Bingo – Operador</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
:root{
    --bg:#F2F2F2;
    --num:#333;
    --called:#1F6B3B;
    --called-text:#FFF;
}

*{ box-sizing:border-box }

html,body{
    margin:0;
    height:100%;
    background:var(--bg);
    font-family:Arial,sans-serif;
}

.container{
    padding:16px;
    display:grid;
    grid-template-rows:auto 1fr auto;
    height:100%;
}

h1{
    margin:0 0 12px;
    text-align:center;
    font-size:clamp(24px,4vw,42px);
    text-transform:uppercase;
    color:#333;
}

/* ===== GRID 1–75 ===== */
.grid{
    display:grid;
    grid-template-columns:repeat(10,1fr);
    gap:12px;
}

.cell{
    display:flex;
    align-items:center;
    justify-content:center;
    padding:14px 0;
    font-size:clamp(18px,2.4vw,32px);
    font-weight:700;
    border-radius:12px;
    border:2px solid #CCC;
    background:#FFF;
    color:var(--num);
    cursor:pointer;
    user-select:none;
}

.cell.called{
    background:var(--called);
    border-color:var(--called);
    color:var(--called-text);
    cursor:default;
}

/* ===== CONTROLES ===== */
.controls{
    margin-top:14px;
    text-align:center;
}

button{
    font-size:18px;
    padding:10px 26px;
    border:none;
    border-radius:10px;
    background:#900;
    color:#FFF;
    cursor:pointer;
}
</style>
</head>

<body>

<div class="container">

    <h1 id="titulo">Bingo da Oomoto – Operador</h1>

    <div class="grid" id="grid"></div>

    <div class="controls">
        <button onclick="resetar()">Resetar Bingo</button>
    </div>

</div>

<script>
/* ===== FIREBASE CONFIG ===== */
const firebaseConfig = {
  apiKey: "AIzaSyBUhyCxXHxwcGIrA8hSrWoOUB55pt3fdFo",
  authDomain: "bingo-yakisoba-kai.firebaseapp.com",
  databaseURL: "https://bingo-yakisoba-kai-default-rtdb.firebaseio.com",
  projectId: "bingo-yakisoba-kai",
  storageBucket: "bingo-yakisoba-kai.firebasestorage.app",
  messagingSenderId: "202647902902",
  appId: "1:202647902902:web:d434bf96ae6de57de36417"
};

firebase.initializeApp(firebaseConfig);
const ref = firebase.database().ref("bingo_atual");

/* ===== ELEMENTOS ===== */
const grid = document.getElementById("grid");
const titulo = document.getElementById("titulo");

/* ===== MAPA NÚMERO → LETRA ===== */
function letraDoNumero(n){
    if(n<=15) return "B";
    if(n<=30) return "I";
    if(n<=45) return "N";
    if(n<=60) return "G";
    return "O";
}

/* ===== CRIAR GRID 1–75 ===== */
for(let i=1;i<=75;i++){
    const d=document.createElement("div");
    d.className="cell";
    d.innerText=i;
    d.id="n"+i;

    d.onclick=()=>{
        ref.once("value",snap=>{
            const data=snap.val()||{};
            const sorteados=data.sorteados||{};

            const chave = letraDoNumero(i)+"-"+i;
            if(sorteados[chave]) return;

            sorteados[chave]=true;

            ref.set({
                titulo: data.titulo || "Bingo da Oomoto",
                ultimo: chave,
                sorteados: sorteados
            });
        });
    };

    grid.appendChild(d);
}

/* ===== SINCRONIZAÇÃO ===== */
ref.on("value",snap=>{
    const data=snap.val();
    if(!data) return;

    titulo.innerText = (data.titulo || "Bingo da Oomoto") + " – Operador";

    document.querySelectorAll(".cell").forEach(c=>{
        c.classList.remove("called");
    });

    if(data.sorteados){
        Object.keys(data.sorteados).forEach(chave=>{
            const n = chave.split("-")[1];
            const cell = document.getElementById("n"+n);
            if(cell) cell.classList.add("called");
        });
    }
});

/* ===== RESET ===== */
function resetar(){
    if(!confirm("Resetar o bingo?")) return;
    ref.set({
        titulo:"Bingo da Oomoto",
        ultimo:"—",
        sorteados:{}
    });
}
</script>

</body>
</html>
