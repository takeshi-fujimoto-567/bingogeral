<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Bingo – Operador</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body{
  margin:0;
  background:#F2F2F2;
  font-family:Arial,sans-serif;
}

.container{
  padding:16px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(10,1fr);
  gap:12px;
}

.cell{
  padding:14px 0;
  text-align:center;
  border:2px solid #DDD;
  border-radius:10px;
  font-size:28px;
  font-weight:900;
  background:#FFF;
  cursor:pointer;
}

.cell.called{
  background:#1F6B3B;
  color:#FFF;
  border-color:#1F6B3B;
}

button{
  margin-top:16px;
  padding:12px 32px;
  font-size:20px;
  border:none;
  border-radius:10px;
  background:#900;
  color:#FFF;
}
</style>
</head>

<body>

<div class="container">
  <h1 id="titulo">Carregando…</h1>
  <div class="grid" id="grid"></div>
  <button onclick="resetar()">Resetar Bingo</button>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const firebaseConfig = {
    apiKey: "AIzaSyBUhyCxXHxwcGIrA8hSrWoOUB55pt3fdFo",
    authDomain: "bingo-yakisoba-kai.firebaseapp.com",
    databaseURL: "https://bingo-yakisoba-kai-default-rtdb.firebaseio.com",
    projectId: "bingo-yakisoba-kai",
    storageBucket: "bingo-yakisoba-kai.firebasestorage.app",
    messagingSenderId: "202647902902",
    appId: "1:202647902902:web:d434bf96ae6de57de36417"
  };

  if (!firebase.apps.length) {
    firebase.initializeApp(firebaseConfig);
  }

  const ref = firebase.database().ref("bingo_atual");
  const titulo = document.getElementById("titulo");
  const grid = document.getElementById("grid");

  function letra(n){
    if(n<=15)return"B";
    if(n<=30)return"I";
    if(n<=45)return"N";
    if(n<=60)return"G";
    return"O";
  }

  for(let i=1;i<=75;i++){
    const key=`${letra(i)}-${i}`;
    const c=document.createElement("div");
    c.className="cell";
    c.innerText=i;
    c.dataset.key=key;
    c.onclick=()=>marcar(key);
    grid.appendChild(c);
  }

  function marcar(key){
    ref.transaction(data=>{
      if(!data) data={titulo:"Bingo da Oomoto",ultimo:"—",sorteados:{}};
      if(data.sorteados[key]) return;
      data.sorteados[key]=true;
      data.ultimo=key;
      return data;
    });
  }

  function resetar(){
    if(!confirm("Resetar o bingo?")) return;
    ref.set({titulo:"Bingo da Oomoto",ultimo:"—",sorteados:{}});
  }

  ref.on("value", snap=>{
    const d=snap.val();

    if(!d || !d.sorteados){
      titulo.innerText="Bingo da Oomoto – Operador";
      document.querySelectorAll(".cell").forEach(c=>c.classList.remove("called"));
      return;
    }

    titulo.innerText=d.titulo+" – Operador";

    document.querySelectorAll(".cell").forEach(c=>{
      if(d.sorteados[c.dataset.key] === true){
        c.classList.add("called");
      }else{
        c.classList.remove("called");
      }
    });
  });

  window.resetar = resetar;
});
</script>

</body>
</html>
